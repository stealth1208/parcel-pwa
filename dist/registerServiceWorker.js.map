{"version":3,"sources":["registerServiceWorker.js"],"names":["SW_PATH","registerServiceWorker","navigator","window","addEventListener","serviceWorker","register","then","onRegistration","catch","error","console","log","registration","controller","preventDevToolsReloadLoop","event","location","reload"],"mappings":";AAqDC,aAAA,OAAA,eAAA,QAAA,cAAA,OAAA,IAAA,QAAA,QAAA,EApDD,IAAMA,EAAN,oBAEe,SAASC,IAChB,kBAAmBC,WACzBC,OAAOC,iBAAyB,OAAA,WAC9BF,UAAUG,cACPC,SAASN,GACTO,KAAKC,GACLC,MAAM,SAAAC,GAASC,OAAAA,QAAQC,IAAqCF,gCAAAA,OAyBnE,SAASF,EAAeK,GAElB,GAACX,UAAUG,cAAcS,WAAzB,CAOAC,IAAAA,GAA4B,EAChCb,UAAUG,cAAcD,iBAAqC,mBAAA,SAAAY,GAGvDD,IACJA,GAA4B,EAC5BZ,OAAOc,SAASC","file":"registerServiceWorker.js","sourceRoot":"..","sourcesContent":["\nconst SW_PATH = `service-worker.js`\n\nexport default function registerServiceWorker() {\n  if (!(`serviceWorker` in navigator)) return\n  window.addEventListener(`load`, () => {\n    navigator.serviceWorker\n      .register(SW_PATH)\n      .then(onRegistration)\n      .catch(error => console.log(`Can't register Service Worker`, error))\n  })\n}\n\n\n\n// https://redfin.engineering/how-to-fix-the-refresh-button-when-using-service-workers-a8e27af6df68#06d3\n// function listenForWaitingServiceWorker(registration, callback) {\n//   function awaitStateChange() {\n//     registration.installing.addEventListener(`statechange`, function() {\n//       if (this.state === `installed`) callback(registration)\n//     })\n//   }\n\n//   if (!registration) return\n\n//   if (registration.waiting) return callback(registration)\n\n//   if (registration.installing) awaitStateChange()\n\n//   registration.addEventListener(`updatefound`, () => {\n//     awaitStateChange()\n//   })\n// }\n\nfunction onRegistration(registration) {\n  // Track updates to the Service Worker.\n  if (!navigator.serviceWorker.controller) {\n    // The window client isn't currently controlled…\n    // …so it's a new service worker that will activate immediately\n    return\n  }\n\n  // When the user asks to refresh the UI, we'll need to reload the window\n  let preventDevToolsReloadLoop = false\n  navigator.serviceWorker.addEventListener(`controllerchange`, event => {\n    // Ensure refresh is only called once.\n    // This works around a bug in \"force update on reload\".\n    if (preventDevToolsReloadLoop) return\n    preventDevToolsReloadLoop = true\n    window.location.reload()\n  })\n\n  // listenForWaitingServiceWorker(registration, showRefreshUI)\n}"]}